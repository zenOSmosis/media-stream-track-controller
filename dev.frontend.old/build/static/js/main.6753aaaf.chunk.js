(this["webpackJsonpdev.frontend"]=this["webpackJsonpdev.frontend"]||[]).push([[0],[,,function(e,t,r){var n=r(13),i=n.EVT_READY,a=n.EVT_UPDATED,o=n.EVT_DESTROYED,c=r(37),u=r(38),s=r(29),d=r(19),l=r(74),v=r(77),f=v.EVT_AVERAGE_AUDIO_LEVEL_CHANGED,p=v.EVT_AUDIO_LEVEL_TICK,h=v.EVT_AUDIO_ERROR,m=v.EVT_AUDIO_ERROR_RECOVERED;e.exports={AudioMediaStreamTrackController:c,VideoMediaStreamTrackController:u,MediaStreamTrackControllerEvents:{EVT_READY:i,EVT_UPDATED:a,EVT_DESTROYED:o},MediaStreamTrackControllerFactory:s,utils:d,debug:l,AudioMediaStreamTrackLevelMonitor:v,AudioMediaStreamTrackLevelMonitorEvents:{EVT_DESTROYED:o,EVT_AVERAGE_AUDIO_LEVEL_CHANGED:f,EVT_AUDIO_LEVEL_TICK:p,EVT_AUDIO_ERROR:h,EVT_AUDIO_ERROR_RECOVERED:m}}},,,,,,,,,,,function(e,t,r){var n=r(3),i=r(4),a=r(5),o=r(6),c=r(12),u=r(14),s=r(11),d=r(8),l=r(9),v=r(31),f=v.EVT_UPDATED,p=v.EVT_DESTROYED,h={},m=function(e){"use strict";d(v,e);var t=l(v);function v(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(this,v),!(e instanceof MediaStreamTrack))throw new TypeError("inputMediaStreamTrack is not of MediaStreamTrack type");return r=t.call(this,n),h[r._uuid]=c(r),r._inputMediaStreamTrack=e,r._outputMediaStreamTrack=e,r._isTrackEnded=!1,setTimeout((function(){var e=function(){r._isTrackEnded||(r._isTrackEnded=!0,r.destroy())};r._inputMediaStreamTrack.addEventListener("ended",e),r._outputMediaStreamTrack.addEventListener("ended",e),r.once(p,(function(){r._inputMediaStreamTrack.removeEventListener("ended",e),r._outputMediaStreamTrack.removeEventListener("ended",e)}))})),r}return o(v,[{key:"getKind",value:function(){return this._inputMediaStreamTrack.kind}},{key:"getOutputMediaStreamTrack",value:function(){return this._outputMediaStreamTrack}},{key:"getOutputTrack",value:function(){return this._outputMediaStreamTrack}},{key:"getTrackKind",value:function(){return this._outputMediaStreamTrack.kind}},{key:"getInputSettings",value:function(){return this._inputMediaStreamTrack.getSettings()}},{key:"getOutputSettings",value:function(){return this._outputMediaStreamTrack.getSettings()}},{key:"getInputDeviceId",value:function(){var e=this.getInputSettings();if(e)return e.deviceId}},{key:"getPartialMediaDeviceInfo",value:function(){return{deviceId:this.getInputDeviceId()}}},{key:"getInputMediaDeviceInfoFromList",value:function(e){var t=r(19).getMatchedMediaDevice,n=this.getPartialMediaDeviceInfo();return t("".concat(this.getKind(),"input"),n,e)}},{key:"destroy",value:function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._inputMediaStreamTrack.stop(),this._outputMediaStreamTrack.stop(),this._outputMediaStreamTrack.dispatchEvent(new Event("ended")),delete h[this._uuid],u(s(v.prototype),"destroy",this).call(this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"getMediaStreamTrackControllerInstances",value:function(){return Object.values(h)}}]),v}(v);e.exports=m,e.exports.EVT_UPDATED=f,e.exports.EVT_DESTROYED=p},,,,,,function(e,t,r){var n=r(28),i=r(67),a=r(69),o=a.getIsScreenCaptureSupported,c=r(70),u=r(30),s=u.getNewAudioContext,d=u.getSharedAudioContext,l=u.untilAudioContextResumed,v=r(71),f=r(72),p=r(73);e.exports={constraints:n,captureMediaDevice:i,captureScreen:a,getIsScreenCaptureSupported:o,fetchMediaDevices:c,getNewAudioContext:s,getSharedAudioContext:d,untilAudioContextResumed:l,getMatchedMediaDevice:v,stopMediaStream:f,getMediaStreamTrackControllerInstances:p}},,,,function(e,t,r){e.exports={levels:"AudioLevelMeter_levels__3RxbJ","level-container":"AudioLevelMeter_level-container__2ByOz",level:"AudioLevelMeter_level__1tSSz","level-animation":"AudioLevelMeter_level-animation__b91Xq"}},,,,,function(e,t,r){var n=r(18),i=r(35),a=r(7);function o(e,t){return a.mergeOptions(e,t)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("audio"!==e&&"video"!==e)throw new TypeError("kind must be either audio or video");if("boolean"===typeof t)return i({},e,t);if(null!==t&&void 0!==t||(t={}),void 0===t[e]){var r=n({},t);t=i({},e,r)}else void 0!==t[e][e]&&(t[e]=n({},t[e][e]));return t}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,sampleRate:48e3,sampleSize:16}};return o(t,c("audio",e))}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={video:{}};return o(t,c("video",e))}function d(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="audio",u="video";if(t!==a&&t!==u)throw new TypeError("deviceType must be audio or video");var s=(i(r={},t,{deviceId:{exact:e}}),i(r,t===a?u:a,!1),r);return!1===(n=c(t,n))[t]?{}:o(n,s)}e.exports={mergeConstraints:o,createNormalizedConstraintsOfKind:c,createAudioConstraints:u,createVideoConstraints:s,createScreenCaptureConstraints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return DEFAULT_CONSTRAINTS=n(n({},u(e&&e.audio)),s(o({cursor:"always"},e&&e.video))),o(DEFAULT_CONSTRAINTS,e)},getSpecificDeviceIdCaptureConstraints:d,getSpecificDeviceCaptureConstraints:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof MediaDeviceInfo))throw console.warn(typeof e),new TypeError("mediaDeviceInfo must be of MediaDeviceInfo type");return d(e.deviceId,"audioinput"===e.kind?"audio":"video",t)}}},function(e,t,r){var n=r(3),i=r(4),a=r(15),o=r(26),c=r(5),u=r(6),s=r(12),d=r(8),l=r(9),v=r(14),f=r(11),p=r(31),h=p.EVT_READY,m=p.EVT_UPDATED,E=p.EVT_DESTROYED,_=r(13),T=r(37),g=r(38),k=r(68),D={},x=function(e){"use strict";d(r,e);var t=l(r);function r(e){var n,i,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(c(this,r),!(e instanceof MediaStream))throw new TypeError("inputMediaStream is not of MediaStream type");var d={isReady:!1};return i=t.call(this,p.mergeOptions(d,u)),D[i._uuid]=s(i),i._trackControllers=r.createTrackControllersFromMediaStream(e,u),function(){var e,t=i._trackControllers.length,a=0,c=o(i._trackControllers);try{var u=function(){var o=e.value;o.onceReady().then((function(){++a===t&&v((n=s(i),f(r.prototype)),"_init",n).call(n)}));var c=k((function(){i._syncTrackControllersMuteState(),i.emit(m)}),0,!1);o.on(m,c),o.once(E,(function(){i._trackControllers=i._trackControllers.filter((function(e){return!Object.is(e,o)})),i.emit(m),o.off(m,c),0===--t&&i.destroy()}))};for(c.s();!(e=c.n()).done;)u()}catch(d){c.e(d)}finally{c.f()}i._trackControllers.length||i.destroy()}(),i._outputMediaStream=new MediaStream(a(i._trackControllers.map((function(e){return e.getOutputMediaStreamTrack()})))),i}return u(r,[{key:"_syncTrackControllersMuteState",value:function(){this._trackControllers.every((function(e){return e.getIsMuted()}))?this._isMuted=!0:this._trackControllers.some((function(e){return!e.getIsMuted()}))&&(this._isMuted=!1)}},{key:"setIsMuted",value:function(e){return this._trackControllers.forEach((function(t){return t.setIsMuted(e)})),v(f(r.prototype),"setIsMuted",this).call(this)}},{key:"getTrackControllers",value:function(){return this._trackControllers}},{key:"getAudioTrackControllers",value:function(){return this.getTrackControllers().filter((function(e){return e instanceof T}))}},{key:"getVideoTrackControllers",value:function(){return this.getTrackControllers().filter((function(e){return e instanceof g}))}},{key:"getOutputMediaStream",value:function(){return this._outputMediaStream}},{key:"getInputDeviceIds",value:function(){return this.getTrackControllers().map((function(e){return e.getInputDeviceId()}))}},{key:"destroy",value:function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete D[this._uuid],e.next=3,Promise.all(this._trackControllers.map((function(e){return e.destroy()})));case 3:v(f(r.prototype),"destroy",this).call(this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"getMediaStreamTrackControllerInstances",value:function(){return _.getMediaStreamTrackControllerInstances()}},{key:"getFactoryInstances",value:function(){return Object.values(D)}},{key:"createTrackControllersFromMediaStream",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],i=o(e.getTracks());try{for(i.s();!(t=i.n()).done;){var a=t.value;switch(a.kind){case"audio":n.push(new T(a,r));break;case"video":n.push(new g(a,r));break;default:throw new TypeError("Unknown track kind: ".concat(a.kind))}}}catch(c){i.e(c)}finally{i.f()}return n}}]),r}(p);e.exports=x,e.exports.EVT_READY=h,e.exports.EVT_UPDATED=m,e.exports.EVT_DESTROYED=E},function(e,t,r){var n=r(3),i=r(4),a=function(){var e=window.AudioContext||window.webkitAudioContext;return e?new e:null},o=function(){var e=a();return function(){return e}}(),c=function(){var e=i(n.mark((function e(){var t,r=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=r.length>0&&void 0!==r[0]?r[0]:null)||(t=o()),"running"===t.state){e.next=8;break}return console.debug("Trying to resume audio context"),e.next=7,t.resume();case 7:console.debug("Audio context resumed");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.exports.getNewAudioContext=a,e.exports.getSharedAudioContext=o,e.exports.untilAudioContextResumed=c},function(e,t,r){var n=r(3),i=r(4),a=r(5),o=r(6),c=r(8),u=r(9),s=r(7),d=s.EVT_UPDATED,l=s.EVT_DESTROYED,v=function(e){"use strict";c(r,e);var t=u(r);function r(){var e;a(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i)))._isMuted=!1,e}return o(r,[{key:"setIsMuted",value:function(e){this._isMuted=e,this.emit(d)}},{key:"getIsMuted",value:function(){return this._isMuted}},{key:"mute",value:function(){this.setIsMuted(!0)}},{key:"unmute",value:function(){this.setIsMuted(!1)}},{key:"toggleMute",value:function(){this.setIsMuted(!this._isMuted)}},{key:"stop",value:function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.destroy());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(s);e.exports=v,e.exports.EVT_UPDATED=d,e.exports.EVT_DESTROYED=l},,,,,,function(e,t,r){var n=r(3),i=r(4),a=r(5),o=r(6),c=r(12),u=r(8),s=r(9),d=r(14),l=r(11),v=r(7),f=r(13),p=f.EVT_UPDATED,h=f.EVT_DESTROYED,m=r(30).getSharedAudioContext,E=function(e){"use strict";u(r,e);var t=s(r);function r(e){var o,u,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(this,r),"audio"!==e.kind)throw new TypeError("inputMediaStreamTrack is not of audio type");var f={isReady:!1};return(u=t.call(this,e,v.mergeOptions(f,s)))._audioCtx=m(),u._unmutedGain=1,i(n.mark((function t(){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u._src=u._audioCtx.createMediaStreamSource(new MediaStream([e])),u._dst=u._audioCtx.createMediaStreamDestination(),u._gainNode=u._audioCtx.createGain(),u._src.connect(u._gainNode),u._gainNode.connect(u._dst),u._outputMediaStream=u._dst.stream,u._outputMediaStreamTrack=u._outputMediaStream.getTracks()[0],t.next=9,d((o=c(u),l(r.prototype)),"_init",o).call(o);case 9:case"end":return t.stop()}}),t)})))(),u}return o(r,[{key:"setIsMuted",value:function(e){this.setGain(e?0:this._unmutedGain,!1),d(l(r.prototype),"setIsMuted",this).call(this,e)}},{key:"setGain",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t&&(this._unmutedGain=e),!this._isReady)throw new Error("AudioMediaStreamTrackController is not ready");this._gainNode&&(this._gainNode.gain.value=e),this.emit(p)}},{key:"getGain",value:function(){if(!this._isReady)throw new Error("AudioMediaStreamTrackController is not ready");return this._gainNode&&this._gainNode.gain&&this._gainNode.gain.value}}]),r}(f);e.exports=E,e.exports.EVT_UPDATED=p,e.exports.EVT_DESTROYED=h},function(e,t,r){var n=r(5),i=r(6),a=r(14),o=r(11),c=r(8),u=r(9),s=r(13),d=s.EVT_UPDATED,l=s.EVT_DESTROYED,v=function(e){"use strict";c(r,e);var t=u(r);function r(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n(this,r),"video"!==e.kind)throw new TypeError("inputMediaStreamTrack is not of video type");return t.call(this,e,i)}return i(r,[{key:"setIsMuted",value:function(e){console.warn("video setIsMuted is not currently implemented"),a(o(r.prototype),"setIsMuted",this).call(this,e)}}]),r}(s);e.exports=v,e.exports.EVT_UPDATED=d,e.exports.EVT_DESTROYED=l},,,,,,,,,function(e,t,r){},,function(e,t,r){},,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(3),i=r(18),a=r(4),o=r(13),c=r(29),u=r(28),s=u.mergeConstraints,d=u.getSpecificDeviceCaptureConstraints,l=u.createAudioConstraints;function v(){return f.apply(this,arguments)}function f(){return(f=a(n.mark((function e(){var t,r,a,o,u=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1&&void 0!==u[1]?u[1]:{},a=i(i({},l(t&&t.audio)),{},{video:!1}),e.next=5,navigator.mediaDevices.getUserMedia(s(a,t));case 5:return o=e.sent,e.abrupt("return",new c(o,r));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=a(n.mark((function e(t){var r,i,a=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},i=a.length>2&&void 0!==a[2]?a[2]:{},e.abrupt("return",v(d(t,"audio",r),i));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=a(n.mark((function e(t){var r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.deviceId){e.next=3;break}throw new ReferenceError("Could not obtain deviceId from mediaDeviceInfo");case 3:return e.abrupt("return",Promise.all(o.getMediaStreamTrackControllerInstances().filter((function(e){return e.getInputDeviceId()===r})).map((function(e){return e.destroy()}))));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){var t=e.deviceId;if(!t)throw new ReferenceError("Could not obtain deviceId from mediaDeviceInfo");return o.getMediaStreamTrackControllerInstances().filter((function(e){return e.getInputDeviceId()===t}))}e.exports=v,e.exports.captureSpecificMediaDevice=function(e){return p.apply(this,arguments)},e.exports.uncaptureSpecificMediaDevice=function(e){return h.apply(this,arguments)},e.exports.getMediaDeviceTrackControllers=m,e.exports.getIsMediaDeviceBeingCaptured=function(e){return m(e).length>0},e.exports.getIsMediaDeviceCaptureSupported=function(){return navigator&&navigator.mediaDevices&&"function"===typeof navigator.mediaDevices.getUserMedia}},,function(e,t,r){var n=r(3),i=r(4),a=r(29),o=r(28).createScreenCaptureConstraints;function c(){return(c=i(n.mark((function e(){var t,r,i,c=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=c.length>1&&void 0!==c[1]?c[1]:{},e.next=4,navigator.mediaDevices.getDisplayMedia(o(t));case 4:return i=e.sent,e.abrupt("return",new a(i,r));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports=function(){return c.apply(this,arguments)},e.exports.getIsScreenCaptureSupported=function(){return navigator&&navigator.mediaDevices&&"function"===typeof navigator.mediaDevices.getDisplayMedia}},function(e,t,r){var n=r(3),i=r(15),a=r(4),o=function(){var e={lastIsAggressive:null,lastMediaDevices:[]};return a(n.mark((function t(){var r,a,o,u,s=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!(s.length>0&&void 0!==s[0])||s[0],navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){t.next=4;break}return console.warn("enumerateDevices() not supported."),t.abrupt("return",[]);case 4:return a=function(){return navigator.mediaDevices.enumerateDevices()},t.next=7,a();case 7:if(o=t.sent,!r||!o.some((function(e){return!e.label.length}))){t.next=16;break}return t.next=11,navigator.mediaDevices.getUserMedia({audio:!0});case 11:return u=t.sent,t.next=14,a();case 14:o=t.sent,u.getTracks().forEach((function(e){return e.stop()}));case 16:return e.lastIsAggressive===r?o=c(e.lastMediaDevices,o):(e.lastIsAggressive=r,e.lastMediaDevices=[]),e.lastMediaDevices=i(o),t.abrupt("return",o);case 19:case"end":return t.stop()}}),t)})))}(),c=function(e,t){var r=e.filter((function(e){return Boolean(t.find((function(t){return t.kind===e.kind&&t.deviceId===e.deviceId})))}));return t.forEach((function(t){Boolean(e.find((function(e){return e.kind===t.kind&&e.deviceId===t.deviceId})))||r.push(t)})),r},u=function(e){return e.filter((function(e){return e.kind.includes("input")}))},s=function(e){return e.filter((function(e){return e.kind.includes("output")}))};e.exports=o,e.exports.cacheDiffMediaDevices=c,e.exports.filterInputMediaDevices=u,e.exports.filterAudioInputDevices=function(e){return u(e).filter((function(e){return e.kind.includes("audio")}))},e.exports.filterVideoInputDevices=function(e){return u(e).filter((function(e){return e.kind.includes("video")}))},e.exports.filterOutputMediaDevices=s,e.exports.filterAudioOutputDevices=function(e){return s(e).filter((function(e){return e.kind.includes("audio")}))},e.exports.filterVideoOutputDevices=function(e){return s(e).filter((function(e){return e.kind.includes("video")}))}},function(e,t){e.exports=function(e,t,r){if(!["audioinput","videoinput","audiooutput","videooutput"].includes(e))throw new ReferenceError('Invalid kind "'.concat(e,'"'));if(t.deviceId){var n=r.find((function(r){return e===r.kind&&t.deviceId===r.deviceId}));if(n)return n}if(t.label){var i=r.find((function(r){return e===r.kind&&t.label===r.label}));if(i)return i}return null}},function(e,t){e.exports=function(e){e.getTracks().forEach((function(t){t.stop(),e.removeTrack(t)}))}},function(e,t,r){var n=r(13);e.exports=function(){return n.getMediaStreamTrackControllerInstances()}},function(e,t,r){var n=r(75),i=r(76);e.exports={createTestAudioMediaStream:n,createTestVideoMediaStream:i}},function(e,t,r){var n=r(19),i=n.getNewAudioContext,a=n.stopMediaStream,o=r(7).logger;e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=880,r=30,n=i(),c=n.createOscillator();c.type="sine",c.frequency.setValueAtTime(t,n.currentTime);var u=n.createGain();u.gain.value=1e-4,u.gain.setValueAtTime(1,n.currentTime);var s=n.createOscillator();s.type="square",s.frequency.setValueAtTime(r,n.currentTime);var d=n.createMediaStreamDestination();s.connect(u.gain),c.connect(u).connect(d),s.start(),c.start(),c.stop(n.currentTime+e);var l=d.stream;return setTimeout((function(){a(l),o.log("stopped media stream"),n.close().then((function(){return o.log("audio context closed")}))}),1e3*e),l}},function(e,t,r){var n=r(19).stopMediaStream,i=r(7).logger;e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=document.createElement("canvas");document.body.appendChild(t);var r=t.captureStream(25);return setTimeout((function(){n(r),document.body.removeChild(t),i.log("stopped media stream")}),1e3*e),r}},function(e,t,r){var n=r(78),i=n.EVT_DESTROYED,a=n.EVT_AVERAGE_AUDIO_LEVEL_CHANGED,o=n.EVT_AUDIO_LEVEL_TICK,c=n.EVT_AUDIO_ERROR,u=n.EVT_AUDIO_ERROR_RECOVERED;e.exports=n,e.exports.EVT_DESTROYED=i,e.exports.EVT_AVERAGE_AUDIO_LEVEL_CHANGED=a,e.exports.EVT_AUDIO_LEVEL_TICK=o,e.exports.EVT_AUDIO_ERROR=c,e.exports.EVT_AUDIO_ERROR_RECOVERED=u},function(e,t,r){var n=r(3),i=r(4),a=r(5),o=r(6),c=r(12),u=r(8),s=r(9),d=r(7),l=d.logger,v=r(79),f=v.EVT_AVERAGE_AUDIO_LEVEL_CHANGED,p=v.EVT_AUDIO_LEVEL_TICK,h=v.EVT_AUDIO_ERROR,m=v.EVT_AUDIO_ERROR_RECOVERED,E=v.EVT_DESTROYED,_={},T={},g=function(e){"use strict";u(r,e);var t=s(r);function r(e){var n;return a(this,r),v.validateAudioTrack(e),(n=t.call(this))._mediaStreamTrack=e,r.addProxyInstance(c(n)),n}return o(r,[{key:"getMediaStreamTrack",value:function(){return this._mediaStreamTrack}}],[{key:"addProxyInstance",value:function(e){var t=e.getMediaStreamTrack(),r=_[t.id];r||((r=new v(t)).once(E,(function(){var e=T[t.id];e&&Object.values(e).forEach((function(e){return e&&e.destroy()}))})),_[t.id]=r,l.debug("Proxied audio monitor created",r)),T[t.id]?++T[t.id]:T[t.id]=1;var a=[f,p,h,m,E],o={};a.forEach((function(t){o[t]=function(r){return e.emit(t,r)},r.on(t,o[t])})),e.once(E,i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.forEach((function(e){return r.off(e,o[e])})),--T[t.id],T[t.id]){e.next=8;break}return delete _[t.id],delete T[t.id],e.next=7,r.destroy();case 7:l.debug("Proxied audio monitor destroyed",r);case 8:case"end":return e.stop()}}),e)}))))}}]),r}(d);e.exports=g,e.exports.EVT_AVERAGE_AUDIO_LEVEL_CHANGED=f,e.exports.EVT_AUDIO_LEVEL_TICK=p,e.exports.EVT_AUDIO_ERROR=h,e.exports.EVT_AUDIO_ERROR_RECOVERED=m,e.exports.EVT_DESTROYED=E},function(e,t,r){var n=r(3),i=r(4),a=r(5),o=r(6),c=r(14),u=r(11),s=r(8),d=r(9),l=r(7),v=l.EVT_DESTROYED,f=r(30).getSharedAudioContext,p="audio-level-changed",h="audio-level-tick",m="audio-error",E="audio-error-recovered",_=function(e){"use strict";s(r,e);var t=d(r);function r(e){var n;return a(this,r),r.validateAudioTrack(e),(n=t.call(this))._mediaStreamTrack=e.clone(),n._silenceErrorDetectionTimeout=null,n._silenceAudioError=null,n._prevAudioLevel=0,n._pollingStartTime=null,n._isMuted=!1,n._analyser=null,n._stream=null,n._source=null,e.addEventListener("ended",(function(){n.destroy()})),function(){var e=function(){n._initAudioLevelPolling()};window.addEventListener("focus",e),n.once(v,(function(){window.removeEventListener("focus",e)}))}(),setTimeout((function(){return n._initAudioLevelPolling()}),50),n}return o(r,[{key:"destroy",value:function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._silenceErrorDetectionTimeout),this._mediaStreamTrack.stop(),this.emit(h,{rms:0,log2Rms:0}),e.next=5,c(u(r.prototype),"destroy",this).call(this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_initAudioLevelPolling",value:function(){var e=i(n.mark((function e(){var t,r,i,a,o=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(this._silenceErrorDetectionTimeout),!this._isDestroyed){e.next=3;break}return e.abrupt("return");case 3:return this._pollingStartTime=this.getTime(),t=f(),e.next=7,t.resume();case 7:if(!this.getIsDestroyed()){e.next=9;break}return e.abrupt("return");case 9:if(this._isAudioContextStarted=!0,r=this._mediaStreamTrack){e.next=13;break}throw new Error("Could not obtain MediaStreamTrack");case 13:this._analyser||(this._analyser=t.createAnalyser(),this._analyser.fftSize=1024,this._analyser.smoothingTimeConstant=.5),this._stream||(this._stream=new MediaStream([r])),this._source||(this._source=t.createMediaStreamSource(this._stream),this._source.connect(this._analyser),this.once(v,(function(){o._source.disconnect(o._analyser)}))),i=new Uint8Array(this._analyser.frequencyBinCount),this.audioLevelDidChange(0),a=this._pollingStartTime,this._handlePollTick({pollingStartTime:a,analyser:this._analyser,samples:i});case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_emitAudioLevelTick",value:function(e){var t=e.rms,r=void 0===t?0:t,n=e.log2Rms,i=void 0===n?0:n;this.emit(h,{rms:r,log2Rms:i})}},{key:"_handlePollTick",value:function(e){var t=this,r=e.pollingStartTime,n=e.analyser,i=e.samples;if(!this._isDestroyed&&r===this._pollingStartTime){if(this._isMuted)-1!==this._prevAudioLevel&&(this._prevAudioLevel=-1,this.audioLevelDidChange(-1));else{n.getByteFrequencyData(i);var a=this.rootMeanSquare(i),o=a&&Math.log2(a);this._emitAudioLevelTick({rms:a,log2Rms:o});var c=Math.ceil(o);c<0?c=0:c>10&&(c=10),this._prevAudioLevel!==c&&(this._prevAudioLevel=c,this.audioLevelDidChange(c))}setTimeout((function(){t.getIsDestroyed()||t._handlePollTick({pollingStartTime:r,analyser:n,samples:i})}),50)}}},{key:"rootMeanSquare",value:function(e){var t=e.reduce((function(e,t){return e+t*t}),0);return Math.sqrt(t/e.length)}},{key:"getTime",value:function(){return(new Date).getTime()}},{key:"setIsMuted",value:function(e){e!==this._isMuted&&(this.log("Setting muted state to ".concat(e?"true":"false")),this._isMuted=e)}},{key:"audioLevelDidChange",value:function(e){this._audioLevel=e,e?this.silenceDidEnd():this.silenceDidStart(),this.emit(p,e)}},{key:"silenceDidStart",value:function(){var e=this;clearTimeout(this._silenceErrorDetectionTimeout),this._silenceErrorDetectionTimeout=setTimeout((function(){e._isDestroyed||e._isMuted||(e._silenceAudioError=new Error("Unintentional silence grace period over"),e.log.error(e._silenceAudioError.message),e.emit(m,e._silenceAudioError))}),1e4)}},{key:"silenceDidEnd",value:function(){if(clearTimeout(this._silenceErrorDetectionTimeout),this._silenceAudioError){var e=this._silenceAudioError;this._silenceAudioError=null,this.emit(E,e)}}}],[{key:"validateAudioTrack",value:function(e){if(!(e instanceof MediaStreamTrack))throw new TypeError("mediaStreamTrack should be of MediaStreamTrack type");if("audio"!==e.kind)throw new TypeError("mediaStreamTrack is not an audio track")}}]),r}(l);e.exports=_,e.exports.EVT_AVERAGE_AUDIO_LEVEL_CHANGED=p,e.exports.EVT_AUDIO_LEVEL_TICK=h,e.exports.EVT_AUDIO_ERROR=m,e.exports.EVT_AUDIO_ERROR_RECOVERED=E},,function(e,t,r){"use strict";r.r(t);var n=r(1),i=r.n(n),a=r(40),o=r.n(a),c=(r(47),r(3)),u=r.n(c),s=r(41),d=r(21),l=r(10),v=(r(49),r(2)),f=r(17),p=r(22),h=r(42),m=r.n(h),E=r(23),_=r.n(E),T=r(0);function g(e){var t=e.className,r=e.percent,i=e.percents,a=void 0===i?[]:i,o=Object(p.a)(e,["className","percent","percents"]),c=Object(n.useMemo)((function(){var e=Object(d.a)(a);return"undefined"!==typeof r&&e.push(r),e=e.map((function(e){return 100-e}))}),[r,a]);return Object(T.jsx)("div",Object(f.a)(Object(f.a)({className:m()(_.a.levels,t)},o),{},{children:c.map((function(e,t){return Object(T.jsx)("div",{className:_.a["level-container"],children:Object(T.jsx)("div",{className:_.a.level,style:{clipPath:"inset(".concat(e,"% 0 0 0)"),WebkitClipPath:"inset(".concat(e,"% 0 0 0)")}})},t)}))}))}var k=v.AudioMediaStreamTrackLevelMonitorEvents.EVT_AUDIO_LEVEL_TICK;function D(e){var t=e.mediaStreamTrack,r=Object(p.a)(e,["mediaStreamTrack"]),i=Object(n.useState)(0),a=Object(l.a)(i,2),o=a[0],c=a[1];return Object(n.useEffect)((function(){if(t){var e=new v.AudioMediaStreamTrackLevelMonitor(t);return e.on(k,(function(e){var t=e.rms;c(t)})),function(){e.destroy()}}}),[t]),Object(T.jsx)(g,Object(f.a)({percent:o},r))}var x=r(7);function y(e){var t=e.trackController,r=e.inputMediaDevices,i=Object(n.useState)(null),a=Object(l.a)(i,2),o=a[0],c=a[1];Object(n.useEffect)((function(){Object(s.a)(u.a.mark((function e(){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!o){e.next=5;break}return e.next=3,t.onceReady();case 3:(r=t.getOutputMediaStreamTrack())&&(o.srcObject=new MediaStream([r]),o.muted=!1,o.play(),o.scrollIntoView());case 5:case"end":return e.stop()}}),e)})))()}),[t,o]);var d=Object(n.useMemo)((function(){return t.getInputDeviceId()}),[t]),f=Object(n.useMemo)((function(){var e=t.getInputMediaDeviceInfoFromList(r);if(e)return JSON.parse(JSON.stringify(e))}),[t,r]);return Object(n.useEffect)((function(){f&&console.log({computedTrackControllers:v.utils.captureMediaDevice.getMediaDeviceTrackControllers(f),isCaptured:v.utils.captureMediaDevice.getIsMediaDeviceBeingCaptured(f)})}),[f]),Object(T.jsxs)("div",{style:{display:"inline-block",border:"1px #000 solid"},children:[Object(T.jsx)("div",{style:{backgroundColor:"#000",color:"#fff",textAlign:"left"},children:f?Object(T.jsxs)("div",{children:[Object(T.jsx)("h3",{children:"Matched Input Media Device"}),Object.entries(f).map((function(e,t){var r=Object(l.a)(e,2),n=r[0],i=r[1];return Object(T.jsxs)("div",{children:[n,": ",i]},t)}))]}):Object(T.jsxs)("div",{children:["Input Device ID: ",d||"N/A"]})}),Object(T.jsx)("video",{muted:!0,playsInline:!0,ref:c,controls:!0,width:300,height:300}),"audio"===t.getTrackKind()&&Object(T.jsxs)("div",{children:[Object(T.jsx)(D,{mediaStreamTrack:t.getOutputMediaStreamTrack(),style:{height:100}}),Object(T.jsx)("button",{onClick:function(){return t.mute()},children:"Mute"}),Object(T.jsx)("button",{onClick:function(){return t.unmute()},children:"Unmute"})]}),Object(T.jsx)("div",{children:Object(T.jsx)("button",{disabled:!Boolean(f),onClick:function(){return v.utils.captureMediaDevice.uncaptureSpecificMediaDevice(f)},children:"Uncapture Device"})})]})}var M=function(){Object(n.useEffect)((function(){var e=new x.PhantomCollection;console.log({collection:e})}),[]);var e=Object(n.useState)([]),t=Object(l.a)(e,2),r=t[0],i=t[1],a=Object(n.useState)([]),o=Object(l.a)(a,2),c=o[0],u=o[1],s=Object(n.useState)([]),f=Object(l.a)(s,2),p=f[0],h=f[1],m=Object(n.useState)([]),E=Object(l.a)(m,2),_=E[0],g=E[1];Object(n.useEffect)((function(){h(v.utils.fetchMediaDevices.filterInputMediaDevices(c)),g(v.utils.fetchMediaDevices.filterOutputMediaDevices(c))}),[c]);var k=Object(n.useCallback)((function(e){x.logger.log("registering controller factory",{controllerFactory:e,outputMediaStream:e.getOutputMediaStream(),outputMediaStreamTracks:e.getOutputMediaStream().getTracks()}),i((function(t){return[].concat(Object(d.a)(t),[e])}))}),[]);Object(n.useEffect)((function(){var e=function(){var e=v.MediaStreamTrackControllerFactory.getFactoryInstances();x.logger.log("updating registered controller factory instances",{factoryInstances:e}),i(e)};return r.forEach((function(t){t.once(v.MediaStreamTrackControllerEvents.EVT_DESTROYED,e),t.on(v.MediaStreamTrackControllerEvents.EVT_UPDATED,e)})),function(){r.forEach((function(t){t.off(v.MediaStreamTrackControllerEvents.EVT_DESTROYED,e),t.off(v.MediaStreamTrackControllerEvents.EVT_UPDATED,e)}))}}),[r]);var D=Object(n.useCallback)((function(){var e=v.debug.createTestAudioMediaStream();k(new v.MediaStreamTrackControllerFactory(e,"pulsatingAudio"))}),[k]);return Object(T.jsxs)("div",{className:"App",children:[Object(T.jsxs)("div",{children:[Object(T.jsx)("h1",{children:"Utils"}),Object(T.jsxs)("div",{style:{border:"1px #ccc solid",margin:5},children:[Object(T.jsx)("h2",{children:"Audio Context"}),Object(T.jsx)("button",{onClick:function(){return alert(v.utils.getSharedAudioContext())},children:"utils.getSharedAudioContext()"})]}),Object(T.jsxs)("div",{style:{border:"1px #ccc solid",margin:5},children:[Object(T.jsx)("h2",{children:"Media Devices"}),[{name:"utils.fetchMediaDevices [aggressive]",cb:function(){return v.utils.fetchMediaDevices().then((function(e){return u(e)}))}},{name:"utils.fetchMediaDevices [non-aggressive]",cb:function(){return v.utils.fetchMediaDevices(!1).then((function(e){return u(e)}))}},{name:"utils.captureMediaDevice()",cb:function(){return v.utils.captureMediaDevice(null,{title:"captureMediaDevice"}).then(k)}},{name:"utils.captureMediaDevice() (with video)",cb:function(){return v.utils.captureMediaDevice({video:!0},{title:"captureMediaDevice-with-video"}).then(k)}}].map((function(e,t){var r=e.name,n=e.cb;return Object(T.jsx)("div",{children:Object(T.jsx)("button",{onClick:n,children:r})},t)}))]}),Object(T.jsxs)("div",{children:[p.length>0&&Object(T.jsxs)("div",{children:[Object(T.jsx)("h3",{children:"Input Media Devices"}),p.map((function(e,t){return Object(T.jsxs)("div",{style:{textAlign:"left",border:"1px #000 solid",overflow:"auto",padding:8,backgroundColor:t%2?"#ccc":"#fff"},children:[e.kind," ",e.label,Object(T.jsx)("button",{style:{float:"right"},onClick:function(){v.utils.captureMediaDevice.captureSpecificMediaDevice(e,null,{title:e.label}).then(k)},children:"Capture"})]},t)}))]}),_.length>0&&Object(T.jsxs)("div",{children:[Object(T.jsx)("h3",{children:"Output Media Devices"}),_.map((function(e,t){return Object(T.jsxs)("div",{style:{textAlign:"left",border:"1px #000 solid",overflow:"auto",padding:8,backgroundColor:t%2?"#ccc":"#fff"},children:[e.kind," ",e.label]},t)}))]}),Object(T.jsxs)("div",{style:{border:"1px #ccc solid",margin:5},children:[Object(T.jsx)("h2",{children:"Screen Capture"}),Object(T.jsx)("button",{onClick:function(){return v.utils.captureScreen(null,{title:"captureScreen"}).then(k)},children:"utils.captureScreen()"}),Object(T.jsx)("button",{onClick:function(){return alert(v.utils.getIsScreenCaptureSupported())},children:"utils.getIsScreenCaptureSupported()"})]})]})]}),Object(T.jsxs)("div",{children:[Object(T.jsx)("h1",{children:"Debug"}),Object(T.jsxs)("div",{children:[Object(T.jsx)("h2",{children:"Pulsating Audio"}),Object(T.jsx)("button",{onClick:function(){return D()},children:"createPulsatingAudio()"})]})]}),Object(T.jsx)("div",{style:{borderTop:"4px #000 solid"},children:r.map((function(e,t){return Object(T.jsxs)("div",{style:{border:"1px #ccc solid"},children:[Object(T.jsxs)("div",{children:["Factory: ",e.getTitle()]}),e.getTrackControllers().map((function(e,t){return Object(T.jsx)(y,{trackController:e,inputMediaDevices:p},t)})),Object(T.jsx)("div",{children:Object(T.jsx)("button",{onClick:function(){return e.destroy()},children:"Destroy"})})]},t)}))})]})},O=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,82)).then((function(t){var r=t.getCLS,n=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;r(e),n(e),i(e),a(e),o(e)}))};o.a.render(Object(T.jsx)(i.a.StrictMode,{children:Object(T.jsx)(M,{})}),document.getElementById("root")),O()}],[[81,1,2]]]);
//# sourceMappingURL=main.6753aaaf.chunk.js.map